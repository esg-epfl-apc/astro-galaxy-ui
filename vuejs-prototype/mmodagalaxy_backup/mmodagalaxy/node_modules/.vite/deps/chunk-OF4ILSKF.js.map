{
  "version": 3,
  "sources": ["../../@bokeh/bokehjs/build/js/lib/models/glyphs/webgl/multi_marker.js"],
  "sourcesContent": ["import { BaseMarkerGL } from \"./base_marker\";\nimport { interleave } from \"./webgl_utils\";\nexport class MultiMarkerGL extends BaseMarkerGL {\n    glyph;\n    static __name__ = \"MultiMarkerGL\";\n    // data properties, either all or none are set.\n    _marker_types;\n    _unique_marker_types;\n    constructor(regl_wrapper, glyph) {\n        super(regl_wrapper, glyph);\n        this.glyph = glyph;\n    }\n    draw(indices, main_glyph, transform) {\n        // The main glyph has the data, this glyph has the visuals.\n        const main_gl_glyph = main_glyph.glglyph;\n        if (main_gl_glyph.data_changed || main_gl_glyph.data_mapped) {\n            main_gl_glyph.set_data();\n            main_gl_glyph.data_changed = false;\n            main_gl_glyph.data_mapped = false;\n        }\n        if (this.visuals_changed) {\n            this._set_visuals();\n            this.visuals_changed = false;\n        }\n        const nmarkers = main_gl_glyph.nvertices;\n        const ntypes = main_gl_glyph._unique_marker_types.length;\n        for (const marker_type of main_gl_glyph._unique_marker_types) {\n            if (marker_type == null) {\n                continue;\n            }\n            let nshow = nmarkers; // Number of markers to show.\n            const prev_nmarkers = this._show.length;\n            const show_array = this._show.get_sized_array(nmarkers);\n            if (ntypes > 1 || indices.length < nmarkers) {\n                this._show_all = false;\n                // Reset all show values to zero.\n                show_array.fill(0);\n                // Set show values of markers to render to 255.\n                nshow = 0;\n                for (const k of indices) { // Marker index.\n                    if (ntypes == 1 || main_gl_glyph._marker_types.get(k) == marker_type) {\n                        show_array[k] = 255;\n                        nshow++;\n                    }\n                }\n            }\n            else if (!this._show_all || prev_nmarkers != nmarkers) {\n                this._show_all = true;\n                show_array.fill(255);\n            }\n            this._show.update();\n            if (nshow == 0) {\n                continue;\n            }\n            this._draw_one_marker_type(marker_type, transform, main_gl_glyph);\n        }\n    }\n    _get_visuals() {\n        return this.glyph.visuals;\n    }\n    _set_data() {\n        const nmarkers = this.nvertices;\n        const centers_array = this._centers.get_sized_array(2 * nmarkers);\n        interleave(this.glyph.sx, this.glyph.sy, nmarkers, BaseMarkerGL.missing_point, centers_array);\n        this._centers.update();\n        this._widths.set_from_prop(this.glyph.size);\n        this._angles.set_from_prop(this.glyph.angle);\n        this._marker_types = this.glyph.marker;\n        this._unique_marker_types = [...new Set(this._marker_types)];\n    }\n    _set_once() {\n        super._set_once();\n        this._heights.set_from_scalar(0);\n        this._auxs.set_from_scalar(0);\n    }\n}\n//# sourceMappingURL=multi_marker.js.map"],
  "mappings": ";;;;;;;;;;;AAEO,IAAM,gBAAN,cAA4B,aAAa;AAAA,EAM5C,YAAY,cAAc,OAAO;AAC7B,UAAM,cAAc,KAAK;AAN7B;AAGA;AAAA;AACA;AAGI,SAAK,QAAQ;AAAA,EACjB;AAAA,EACA,KAAK,SAAS,YAAY,WAAW;AAEjC,UAAM,gBAAgB,WAAW;AACjC,QAAI,cAAc,gBAAgB,cAAc,aAAa;AACzD,oBAAc,SAAS;AACvB,oBAAc,eAAe;AAC7B,oBAAc,cAAc;AAAA,IAChC;AACA,QAAI,KAAK,iBAAiB;AACtB,WAAK,aAAa;AAClB,WAAK,kBAAkB;AAAA,IAC3B;AACA,UAAM,WAAW,cAAc;AAC/B,UAAM,SAAS,cAAc,qBAAqB;AAClD,eAAW,eAAe,cAAc,sBAAsB;AAC1D,UAAI,eAAe,MAAM;AACrB;AAAA,MACJ;AACA,UAAI,QAAQ;AACZ,YAAM,gBAAgB,KAAK,MAAM;AACjC,YAAM,aAAa,KAAK,MAAM,gBAAgB,QAAQ;AACtD,UAAI,SAAS,KAAK,QAAQ,SAAS,UAAU;AACzC,aAAK,YAAY;AAEjB,mBAAW,KAAK,CAAC;AAEjB,gBAAQ;AACR,mBAAW,KAAK,SAAS;AACrB,cAAI,UAAU,KAAK,cAAc,cAAc,IAAI,CAAC,KAAK,aAAa;AAClE,uBAAW,CAAC,IAAI;AAChB;AAAA,UACJ;AAAA,QACJ;AAAA,MACJ,WACS,CAAC,KAAK,aAAa,iBAAiB,UAAU;AACnD,aAAK,YAAY;AACjB,mBAAW,KAAK,GAAG;AAAA,MACvB;AACA,WAAK,MAAM,OAAO;AAClB,UAAI,SAAS,GAAG;AACZ;AAAA,MACJ;AACA,WAAK,sBAAsB,aAAa,WAAW,aAAa;AAAA,IACpE;AAAA,EACJ;AAAA,EACA,eAAe;AACX,WAAO,KAAK,MAAM;AAAA,EACtB;AAAA,EACA,YAAY;AACR,UAAM,WAAW,KAAK;AACtB,UAAM,gBAAgB,KAAK,SAAS,gBAAgB,IAAI,QAAQ;AAChE,eAAW,KAAK,MAAM,IAAI,KAAK,MAAM,IAAI,UAAU,aAAa,eAAe,aAAa;AAC5F,SAAK,SAAS,OAAO;AACrB,SAAK,QAAQ,cAAc,KAAK,MAAM,IAAI;AAC1C,SAAK,QAAQ,cAAc,KAAK,MAAM,KAAK;AAC3C,SAAK,gBAAgB,KAAK,MAAM;AAChC,SAAK,uBAAuB,CAAC,GAAG,IAAI,IAAI,KAAK,aAAa,CAAC;AAAA,EAC/D;AAAA,EACA,YAAY;AACR,UAAM,UAAU;AAChB,SAAK,SAAS,gBAAgB,CAAC;AAC/B,SAAK,MAAM,gBAAgB,CAAC;AAAA,EAChC;AACJ;AAvEI,cAFS,eAEF,YAAW;",
  "names": []
}
